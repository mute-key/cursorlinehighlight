"use strict";var Ce=Object.create;var h=Object.defineProperty;var Ee=Object.getOwnPropertyDescriptor;var Le=Object.getOwnPropertyNames;var Oe=Object.getPrototypeOf,xe=Object.prototype.hasOwnProperty;var me=(e,t)=>{for(var o in t)h(e,o,{get:t[o],enumerable:!0})},A=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Le(t))!xe.call(e,i)&&i!==o&&h(e,i,{get:()=>t[i],enumerable:!(n=Ee(t,i))||n.enumerable});return e};var y=(e,t,o)=>(o=e!=null?Ce(Oe(e)):{},A(t||!e||!e.__esModule?h(o,"default",{value:e,enumerable:!0}):o,e)),he=e=>A(h({},"__esModule",{value:!0}),e);var tt={};me(tt,{activate:()=>Ze,deactivate:()=>et});module.exports=he(tt);var B=y(require("vscode"));var p=y(require("vscode"));var x=y(require("vscode")),k=(e,t)=>{let o=x.window.showInformationMessage(e);setTimeout(()=>{o?.then(()=>{})},t)},S=e=>{x.window.showErrorMessage("Invalid Value(s) in Configuration.","Fix Configuration","Ignore").then(t=>{t==="Fix Configuration"&&x.commands.executeCommand("workbench.action.openSettings",e.join(" "))})},u={indentAndEOLRegex:e=>new RegExp(`^( {${e}}|[\r
]+)*$`,"gm"),tagtAndEOLRegex:/(\t|[\r\n]+)*$/gm,isValidHexColor:/^#[A-Fa-f0-9]{6}$/,isValidWidth:/^[0-9]px$|^[0-9]em$/},$=(e,t,o,n)=>{let i=n||4,r=[];for(;i--;)e>>i&1?r.push(t):r.push(o);return r},N=e=>{let t=2166136261;for(let o=0;o<e.length;o++)t^=e.charCodeAt(o),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24),t=t>>>0;return t.toString(16)},X=e=>e.charAt(0).toUpperCase()+e.slice(1),D=(e,t=.6,o,n)=>{e=e.replace(/^#/,""),e.length===3&&(e=e.split("").map(c=>c+c).join("")),/^[0-9A-Fa-f]{6}$/.test(e)||(e=o.replace(/^#/,""),t=n);let r=parseInt(e.substring(0,2),16),s=parseInt(e.substring(2,4),16),a=parseInt(e.substring(4,6),16);return`rgba(${r}, ${s}, ${a}, ${t})`};var j={name:void 0,config:void 0,configHashKey:void 0,borderPositionInfo:{CURSOR_ONLY:void 0,SINGLE_LINE:void 0,MULTI_LINE:void 0,MULTI_CURSOR:void 0},generalConfigInfo:{borderOpacity:void 0,backgroundOpacity:void 0,statusTextEnabled:void 0},statusTextConfig:{statusTextColor:void 0,statusTextOpacity:void 0,statusTextBackgroundColor:void 0,statusTextFontStyle:void 0,statusTextFontWeight:void 0},configError:void 0},Y={indent:{size:void 0,type:void 0,regex:void 0},statusText:{isWholeLine:void 0,rangeBehavior:void 0,after:{contentText:void 0,color:void 0,backgroundColor:void 0,fontWeight:void 0,fontStyle:void 0,textDecoration:"none",margin:"0 0 0 20px"}}},V={status:{decorationType:void 0},decorationList:{CURSOR_ONLY:void 0,SINGLE_LINE:void 0,MULTI_LINE:void 0,MULTI_CURSOR:void 0},appliedDecoration:{applied:void 0,editorDecoration:void 0}},U={none:[0],bottom:[2,0],"top-bottom":[10],"top-right-bottom-left":[15,0],left:[1]},Se={none:[0,0,0],"top-bottom":[8,2,0],left:[1,1,1]},R={CURSOR_ONLY:U,SINGLE_LINE:U,MULTI_LINE:Se,MULTI_CURSOR:U},T={RESET:{KEY:"RESET",MASK:15},CURSOR_ONLY:{KEY:"CURSOR_ONLY",MASK:1},SINGLE_LINE:{KEY:"SINGLE_LINE",MASK:2},MULTI_LINE:{KEY:"MULTI_LINE",MASK:4},MULTI_CURSOR:{KEY:"MULTI_CURSOR",MASK:8}},J={CURSOR_ONLY:"cursorOnly",SINGLE_LINE:"singleLine",MULTI_LINE:"multiLine",MULTI_CURSOR:"multiCursor"},K={borderOpacity:1,backgroundOpacity:.5,statusTextEnabled:!0},v={statusTextColor:"#FF0000",statusTextOpacity:1,statusTextBackgroundColor:null,statusTextFontStyle:"normal",statusTextFontWeight:"bold"},q={CURSOR_ONLY:{isWholeLine:!0,borderWidth:"2px",borderStyle:"dotted",borderColor:"#ff0000",borderPosition:"bottom",backgroundColor:"#ff0000"},SINGLE_LINE:{isWholeLine:!1,borderWidth:"2px",borderStyle:"dotted",borderColor:"#ff0000",borderPosition:"bottom",backgroundColor:"#ff0000"},MULTI_LINE:{isWholeLine:!0,borderWidth:"2px",borderStyle:"dotted",borderColor:"#ff0000",borderPosition:"bottom",backgroundColor:"#ff0000"},MULTI_CURSOR:{isWholeLine:!1,borderWidth:"2px",borderStyle:"dotted",borderColor:"#ff0000",borderPosition:"bottom",backgroundColor:"#ff0000"}};var re=y(require("vscode"));var g=y(require("vscode"));var _=(e,t)=>{e.indent.size=Number(t.options.tabSize??t.options.indentSize??4),e.indent.type=t.options.insertSpaces?`
`:"	",e.indent.regex=t.options.insertSpaces?u.indentAndEOLRegex(e.indent.size):u.tagtAndEOLRegex},Q=e=>{if(e.selections.length===1)return e.selections[0].isEmpty?T.CURSOR_ONLY:e.selections[0].isSingleLine?T.SINGLE_LINE:T.MULTI_LINE;if(e.selections.length>1)return T.MULTI_CURSOR},C=(e,t,o,n)=>new g.Range(new g.Position(e,t),new g.Position(o,n)),d=(e,t)=>new g.Range(e,t),Z=(e,t,o)=>new g.Range(new g.Position(e,t),o);var ee=e=>{let{editor:t,borderConfig:o,textEditorDecoration:n}=e;return o.isWholeLine?[{decoration:n[0],range:[d(t.selection.active,t.selection.active)]}]:o.beforeCursor?[{decoration:n[0],range:[C(t.selection.active.line,0,t.selection.active.line,t.selection.active.character)]}]:o.afterCursor?[{decoration:n[0],range:[Z(t.selection.active.line,t.selection.active.character,t.document.lineAt(t.selection.active.line).range.end)]},{decoration:n[1],range:[C(t.selection.active.line,0,t.selection.active.line,t.selection.active.character)]}]:[]},te=({editor:e,borderConfig:t,textEditorDecoration:o})=>[{decoration:o[0],range:[d(e.selection.start,e.selection.end)]}],oe=({editor:e,borderConfig:t,textEditorDecoration:o})=>{if(t.borderPosition==="left")return[{decoration:o[2],range:[C(e.selection.start.line,e.selection.start.character,e.selection.end.line,e.selection.end.character)]}];{let n=[];return n.push({decoration:o[0],range:[d(e.selection.start,e.selection.start)]},{decoration:o[1],range:[d(e.selection.end,e.selection.end)]}),Math.abs(e.selection.start.line-e.selection.end.line)>1?n.push({decoration:o[2],range:[C(e.selection.start.line+1,e.selection.start.character,e.selection.end.line-1,e.selection.end.character)]}):f(e,o[2],[]),n}},ne=({editor:e,borderConfig:t,textEditorDecoration:o})=>[{decoration:o[0],range:e.selections.reduce((n,i)=>(n.push(d(i.start,i.active)),n),[])},{decoration:o[1],range:e.selections.reduce((n,i)=>(n.push(C(i.active.line,0,i.active.line,i.active.character)),n),[])}];var m={CURSOR_ONLY:{contentText:(e,t)=>e===t?`< Editing ... At (Col ${e})`:`< Editing ... At (Col ${e}/${t})`},SINGLE_LINE:{contentText:e=>`< Selection ... Of (${e} Characters)`},MULTI_LINE:{contentText:(e,t,o)=>`< Selection ${o} ... Of (${e} Lines, ${t} Characters, Indent/EOL Ignored)`},MULTI_CURSOR:{contentText:(e,t,o,n)=>`< Multi Selection ... Of (${e} of ${t}, with Total ${o} Lines ${n} Characters )`}},De=(e,t)=>[{contentText:m[t.KEY].contentText(e.selection.active.character,e.document.lineAt(e.selection.active.line).text.length),range:d(e.selection.active,e.selection.active),isWholeLine:!0}],Re=(e,t)=>[{contentText:m[t.KEY].contentText(Math.abs(e.selection.end.character-e.selection.start.character)),range:d(e.selection.active,e.selection.active),isWholeLine:!0}],ve=(e,t,o)=>{let i=e.document.getText(e.selection).replace(t.regex,"").length,r=Math.abs(e.selection.end.line-e.selection.start.line)+1;return[{contentText:m[o.KEY].contentText(r,i,"Anchor"),range:d(e.selection.anchor,e.selection.anchor),isWholeLine:!0},{contentText:m[o.KEY].contentText(r,i,"Cursor"),range:d(e.selection.active,e.selection.active),isWholeLine:!0}]},Ie=(e,t,o)=>{let n=e.selections.length,i=0,r=0,s=0,a=e.selections[0].start.line===e.selections[0].end.line,c=0,G=[],P=[];for(c=a?1:Math.abs(e.selections[0].end.line-e.selections[0].start.line)+1;i<n;){if(a)r=r+(e.selections[i].end.character-e.selections[i].start.character),s=s+c;else{let H=e.document.getText(e.selections[i]);r=r+H.replace(t.regex,"").length,s=s+c}i++}for(i=n;i--;)new Set(P).has(e.selections[i].end.line)||(G.push({contentText:m[o.KEY].contentText(i+1,n,s,r),range:d(e.selections[i].start,e.selections[i].end),isWholeLine:!0}),P.push(e.selections[i].end.line),i++);return G},be=(e,t)=>(t.isWholeLine=e.isWholeLine,t.after.contentText=e.contentText,t),w=e=>{if(e.statusText){let t=e.statusText.length;for(;t--;)e.statusText[t].dispose();e.statusText=void 0}},Ne=(e,t,o)=>({CURSOR_ONLY:()=>De(e,o),SINGLE_LINE:()=>Re(e,o),MULTI_LINE:()=>ve(e,t,o),MULTI_CURSOR:()=>Ie(e,t,o)}),ie=(e,t,o,n)=>{let i=Ne(e,o.indent,n)[n.KEY](),r=[],s=i.length;for(;s--;){let a=I(be(i[s],o.statusText));f(e,a,[i[s].range]),r.push(a)}w(t),t.statusText=r};var f=(e,t,o)=>e.setDecorations(t,o),I=e=>re.window.createTextEditorDecorationType(e),F=e=>e.forEach(t=>{t.dispose()}),Ue=(e,t)=>t.forEach(o=>f(e,o,[])),_e=(e,t,o)=>n=>t?(e.statusText?.forEach(i=>{i.dispose()}),e.decorationList[n.KEY]?.forEach(i=>{Array.isArray(i)?i.forEach(r=>{f(t,r,[])}):f(t,i,[])}),!0):!1,we=(e,t)=>Object.values(T).filter(o=>e.MASK&o.MASK).map(o=>t(o)).every(Boolean),se=(e,t,o)=>we(T.RESET,n=>_e(e,t,o)(n)),ae=(e,t,o)=>t.appliedDecoration.applied?t.appliedDecoration.applied.MASK!==o.MASK?(Ue(e,t.decorationList[t.appliedDecoration.applied.KEY]),t.appliedDecoration.applied=o,!0):!1:(t.appliedDecoration.applied=o,!0),Fe={CURSOR_ONLY:e=>ee(e),SINGLE_LINE:e=>te(e),MULTI_LINE:e=>oe(e),MULTI_CURSOR:e=>ne(e)},We=({editor:e,configInfo:t,statusInfo:o,decorationInfo:n,decorationState:i})=>{let r=i.decorationList[n.KEY];if(r){let s=t.borderPositionInfo[n.KEY];return Fe[n.KEY]({editor:e,borderConfig:s,textEditorDecoration:r})}},E=({editor:e,configInfo:t,statusInfo:o,decorationInfo:n,decorationState:i})=>{let r=i.decorationList[n.KEY];if(r){i.appliedDecoration.editorDecoration=r;let s=We({editor:e,configInfo:t,statusInfo:o,decorationInfo:n,decorationState:i});if(!s)return;t.generalConfigInfo.statusTextEnabled&&ie(e,i,o,n),s.forEach(({decoration:a,range:c})=>{f(e,a,c)})}};var L={...j},W={...Y},O={...V},Te=e=>Object.entries(e.config).reduce((t,[o,n])=>((typeof n=="string"||typeof n=="number"||typeof n=="boolean")&&t.push(n),t),[]).join(""),Me=e=>{let t=Te(e);return N(t)},Be=e=>{e.configHashKey=N(Te(e))},Ge=e=>{let t=Me(e);return e.configHashKey===t?!1:(O.appliedDecoration.editorDecoration&&(O.appliedDecoration.applied=void 0,F(O.appliedDecoration.editorDecoration)),e.configError=[],e.config=p.workspace.getConfiguration(e.name),e.configHashKey=t,e.configError.length===0&&k("Config has been changed. Reloading configuration. (Messaage Dismiss in 2 second.)",1500),!0)},Pe=(e,t)=>{let o=p.workspace.getConfiguration("editor");t===null||t==="null"||String(t).length===0?o.update(e,null,p.ConfigurationTarget.Global):o.update(e,t,p.ConfigurationTarget.Global)},He=()=>{let e=p.workspace.getConfiguration("editor");e.update("renderLineHighlight","gutter",p.ConfigurationTarget.Global),e.update("roundedSelection",!1,p.ConfigurationTarget.Global)},Ae=(e,t)=>e,ke=(e,t)=>t.reduce((o,n)=>n(o),e),$e=(e,t,o,n)=>({bordercolor:()=>(u.isValidHexColor.test(String(o))||e.configError.push(t),n),backgroundcolor:()=>o===null||o==="null"||String(o).length===0?(Pe(t,null),null):(u.isValidHexColor.test(String(o))||e.configError.push(t),n),borderwidth:()=>(u.isValidWidth.test(String(o))||e.configError.push(t),n)}),Xe=(e,t,o,n,i)=>{let r=t+o,s=e.name+"."+r,a=$e(e,s,n,i)[r.toLowerCase()];return a?a():n},M=(e,t,o,n,i)=>{try{let r=o;i&&i.length&&(r=ke(o,i));let s=e.config.get(t+r,n);return s===void 0&&console.warn(`Config value for ${o} is undefined or caused an error. Using default value.`),Xe(e,t,r,s,n)}catch(r){return console.error(`Failed to get config value for ${t+o}:`,r),n}},ce={borderColor:{of:"borderOpacity",fn:(e,t,o)=>D(e,t,o)},backgroundColor:{of:"backgroundOpacity",fn:(e,t,o)=>D(e,t,o)}},ze=(e,t)=>{let o=J[t],n=q[t];return Object.entries(n).reduce((i,[r,s])=>{let a=M(e,o,Ae(r,n),s,[X]);if(a!=null)if(Object.hasOwn(ce,r)){let c=ce[r];i[r]=c.fn(a,e.generalConfigInfo[c.of],s)}else i[r]=a;return i},{})},je=(e,t,o)=>{try{let n=o(e,t);if(!n||n.length===0)return;let i=n.reduce((r,s)=>{let a={...e};return a.borderWidth=s,r.push(a),r},[]).reduce((r,s)=>(r.push(I(s)),r),[]);return i.length===0?void 0:i}catch(n){console.log("creating decoration type thrown error:",t,n);return}},Ye=(e,t)=>{if(Object.hasOwn(R,t))return Object.hasOwn(R[t],e.borderPosition)?Ve(e,R[t][e.borderPosition]):void 0},Ve=(e,t)=>{let o=[];for(let n of t){let i=$(n,e.borderWidth,"0");o.push(i.join(" "))}return o},Je=(e,t)=>{let o=t.replaceAll(" ","").split("|"),n=!1,i=!1,r=!1,s=!1,a=!1;return o.length>1&&(n=/isWholeLine/s.test(o[1]),i=/beforeCursor/s.test(o[1]),r=/afterCursor/s.test(o[1]),s=/atLineStart/s.test(o[1]),a=/selectionOnly/s.test(o[1]),e==="MULTI_LINE"&&o[0]==="left"&&(n=!0)),{isWholeLine:n,borderPosition:o[0],beforeCursor:i,afterCursor:r,atLineStart:s,selectionOnly:a}},Ke=(e,t)=>{let o=p.workspace.getConfiguration("editor"),n=o.get("tabSize"),i=o.get("insertSpaces");if(t.indent.size=Number(n||4),t.indent.type=i?`
`:"	",t.indent.regex=i?u.indentAndEOLRegex(t.indent.size):u.tagtAndEOLRegex,e.statusTextConfig){let r=e.statusTextConfig.statusTextColor,s=e.statusTextConfig.statusTextOpacity,a=v.statusTextColor,c=v.statusTextOpacity;t.statusText.rangeBehavior=p.DecorationRangeBehavior.ClosedClosed,t.statusText.after.color=D(r,s,a,c),t.statusText.after.backgroundColor=e.statusTextConfig.statusTextBackgroundColor,t.statusText.after.fontWeight=e.statusTextConfig.statusTextFontWeight,t.statusText.after.fontStyle=e.statusTextConfig.statusTextFontStyle}},qe=(e,t,o)=>{for(let n in e.generalConfigInfo)e.generalConfigInfo[n]=M(e,"",n,K[n]);for(let n in o.decorationList){let i=n;o.decorationList[i]&&F(o.decorationList[i]);let r=ze(e,i),s=Je(i,r.borderPosition);e.borderPositionInfo[i]=s,r.borderPosition=s.borderPosition,r.isWholeLine=s.isWholeLine;let a=je(r,i,Ye);if(!a)return!1;o.decorationList[i]=a}if(e.generalConfigInfo.statusTextEnabled){o.statusText&&w(o);for(let n in e.statusTextConfig)e.statusTextConfig[n]=M(e,"",n,v[n]);Ke(e,t)}return!0},b=e=>{let t=e.extension.packageJSON.name;if(!t||(L.name=t,L.config=p.workspace.getConfiguration(L.name),!L.name&&!L.config))return;let o=L;if(o.configError||(o.configError=[]),!o.configHashKey)Be(o),He();else if(!Ge(o))return{config:o,decoration:O,status:W};if(qe(o,W,O))return{config:o,decoration:O,status:W}};var l=y(require("vscode"));var de=(e,t,o)=>l.window.onDidChangeWindowState(n=>{n.focused?l.window.activeTextEditor&&E({editor:l.window.activeTextEditor,configInfo:e,statusInfo:t,decorationState:o,decorationInfo:T.CURSOR_ONLY}):l.window.visibleTextEditors.forEach(i=>{se(o,i,!0)})}),le=(e,t,o)=>l.window.onDidChangeActiveTextEditor(n=>{n&&(e.configError.length>0&&S(e.configError),_(t,n),l.window.visibleTextEditors.forEach(i=>{o.appliedDecoration.editorDecoration!==void 0&&o.appliedDecoration.editorDecoration.forEach(r=>{f(i,r,[])})}),E({editor:n,configInfo:e,statusInfo:t,decorationState:o,decorationInfo:T.CURSOR_ONLY}))}),fe=e=>l.window.onDidChangeTextEditorOptions(t=>{_(e,t.textEditor)}),ue=(e,t,o)=>l.window.onDidChangeTextEditorSelection(n=>{if(n.selections){let i=Q(n.textEditor);if(!i||(ae(n.textEditor,o,i),!o.decorationList[i.KEY]))return;E({editor:n.textEditor,configInfo:e,statusInfo:t,decorationState:o,decorationInfo:i})}}),ge=e=>l.workspace.onDidChangeConfiguration(t=>{if(t){let o=b(e)}});var ye=async e=>{try{await e.extension.activate();let t=b(e);if(!t){console.error("Failed to initialize config.");return}let o=t.config,n=t.status,i=t.decoration;if(!i.decorationList){console.error("Failed to initialize decorationList.");return}let r=B.window.activeTextEditor;return o.configError.length>0&&S(o.configError),r&&E({editor:r,configInfo:o,statusInfo:n,decorationInfo:T.CURSOR_ONLY,decorationState:i}),[de(o,n,i),le(o,n,i),ue(o,n,i),fe(n),ge(e)]}catch(t){console.error("Error during extension activation: ",t),B.window.showErrorMessage("Extension activation failed!",t)}};function Ze(e){ye(e).then(t=>{t&&e.subscriptions.push(...t)})}function et(){}0&&(module.exports={activate,deactivate});
