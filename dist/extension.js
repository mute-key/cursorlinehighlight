"use strict";var re=Object.create;var x=Object.defineProperty;var se=Object.getOwnPropertyDescriptor;var ae=Object.getOwnPropertyNames;var ce=Object.getPrototypeOf,de=Object.prototype.hasOwnProperty;var Te=(e,t)=>{for(var o in t)x(e,o,{get:t[o],enumerable:!0})},B=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ae(t))!de.call(e,i)&&i!==o&&x(e,i,{get:()=>t[i],enumerable:!(n=se(t,i))||n.enumerable});return e};var L=(e,t,o)=>(o=e!=null?re(ce(e)):{},B(t||!e||!e.__esModule?x(o,"default",{value:e,enumerable:!0}):o,e)),pe=e=>B(x({},"__esModule",{value:!0}),e);var Ye={};Te(Ye,{activate:()=>Ke,deactivate:()=>Je});module.exports=pe(Ye);var c=L(require("vscode"));var d=L(require("vscode"));var C=L(require("vscode")),I=(e,t)=>{let o=C.window.showInformationMessage(e);setTimeout(()=>{o?.then(()=>{})},t)},D=e=>{C.window.showErrorMessage("Invalid Value(s) in Configuration.","Fix Configuration","Ignore").then(t=>{t==="Fix Configuration"&&C.commands.executeCommand("workbench.action.openSettings",e.join(" "))})},g={indentRegex:e=>new RegExp(`^( {${e}}|[\r
]+)*$`,"gm"),tagRegex:/(\t|[\r\n]+)*$/gm,isValidHexColor:/^#[A-Fa-f0-9]{6}$/,isValidWidth:/^[0-9]px$|^[0-9]em$/},F=(e,t,o,n)=>{let i=n||4,r=[];for(;i--;)e>>i&1?r.push(t):r.push(o);return r},U=e=>{let t=2166136261;for(let o=0;o<e.length;o++)t^=e.charCodeAt(o),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24),t=t>>>0;return t.toString(16)},P=e=>e.charAt(0).toUpperCase()+e.slice(1),E=(e,t=.6,o,n)=>{e=e.replace(/^#/,""),e.length===3&&(e=e.split("").map(T=>T+T).join("")),/^[0-9A-Fa-f]{6}$/.test(e)||(e=o.replace(/^#/,""),t=n);let r=parseInt(e.substring(0,2),16),s=parseInt(e.substring(2,4),16),a=parseInt(e.substring(4,6),16);return`rgba(${r}, ${s}, ${a}, ${t})`};var H={name:void 0,config:void 0,configHashKey:void 0,status:{position:void 0,decorationType:void 0,indent:{size:void 0,type:void 0}},decorationList:{CURSOR_ONLY:void 0,SINGLE_LINE:void 0,MULTI_LINE:void 0,MULTI_CURSOR:void 0},borderPositionInfo:{CURSOR_ONLY:void 0,SINGLE_LINE:void 0,MULTI_LINE:void 0,MULTI_CURSOR:void 0},generalConfigInfo:{borderOpacity:void 0,backgroundOpacity:void 0,statusTextEnabled:void 0,statusTextColor:void 0,statusTextOpacity:void 0,statusTextBackgroundColor:void 0},configError:void 0},k={applied:void 0,editorDecoration:void 0},N={none:[0],bottom:[2,0],"top-bottom":[10],"top-right-bottom-left":[15,0],left:[1]},le={none:[0,0,0],"top-bottom":[8,2,0],left:[1,1,1]},S={CURSOR_ONLY:N,SINGLE_LINE:N,MULTI_LINE:le,MULTI_CURSOR:N},p={RESET:{KEY:"RESET",MASK:15},CURSOR_ONLY:{KEY:"CURSOR_ONLY",MASK:1},SINGLE_LINE:{KEY:"SINGLE_LINE",MASK:2},MULTI_LINE:{KEY:"MULTI_LINE",MASK:4},MULTI_CURSOR:{KEY:"MULTI_CURSOR",MASK:8}},$={CURSOR_ONLY:"cursorOnly",SINGLE_LINE:"singleLine",MULTI_LINE:"multiLine",MULTI_CURSOR:"multiCursor"},R={borderOpacity:1,backgroundOpacity:.5,statusTextEnabled:!0,statusTextColor:"#FF0000",statusTextOpacity:1,statusTextBackgroundColor:null},z={CURSOR_ONLY:{isWholeLine:!0,borderWidth:"2px",borderStyle:"dotted",borderColor:"#ff0000",borderPosition:"bottom",backgroundColor:"#ff0000"},SINGLE_LINE:{isWholeLine:!1,borderWidth:"2px",borderStyle:"dotted",borderColor:"#ff0000",borderPosition:"bottom",backgroundColor:"#ff0000"},MULTI_LINE:{isWholeLine:!0,borderWidth:"2px",borderStyle:"dotted",borderColor:"#ff0000",borderPosition:"bottom",backgroundColor:"#ff0000"},MULTI_CURSOR:{isWholeLine:!1,borderWidth:"2px",borderStyle:"dotted",borderColor:"#ff0000",borderPosition:"bottom",backgroundColor:"#ff0000"}};var A=L(require("vscode")),f=(e,t,o)=>e.setDecorations(t,o),b=e=>A.window.createTextEditorDecorationType(e),j=e=>e.forEach(t=>{t.dispose()});var y={...H},K=e=>Object.entries(e.config).reduce((t,[o,n])=>((typeof n=="string"||typeof n=="number"||typeof n=="boolean")&&t.push(n),t),[]).join(""),ue=e=>{let t=K(e);return U(t)},fe=e=>{e.configHashKey=U(K(e))},ge=e=>{let t=ue(e);return e.configHashKey===t?!1:(e.configError=[],e.config=d.workspace.getConfiguration(e.name),e.configHashKey=t,e.configError.length===0?I("Config has been changed. Reloading configuration. (Messaage Dismiss in 2 second.)",1500):I("error in config",1500),!0)},ye=(e,t)=>{let o=d.workspace.getConfiguration("editor");t===null||t==="null"||String(t).length===0?o.update(e,null,d.ConfigurationTarget.Global):o.update(e,t,d.ConfigurationTarget.Global)},Le=e=>{let t=d.workspace.getConfiguration("editor");t.update("renderLineHighlight","gutter",d.ConfigurationTarget.Global),t.update("roundedSelection",!1,d.ConfigurationTarget.Global),t.update("cursorBlinking","phase",d.ConfigurationTarget.Global);let o=t.get("tabSize"),n=t.get("insertSpaces");e.status.indent.size=Number(o||4),e.status.indent.type=n?`
`:"	",e.status.indent.regex=n?g.indentRegex(e.status.indent.size):g.tagRegex},_=e=>{let t=e.extension.packageJSON.name;if(!t||(y.name=t,y.config=d.workspace.getConfiguration(y.name),!y.name&&!y.config))return;let o=y;if(o.configError||(o.configError=[]),!o.configHashKey)fe(o),Le(o);else if(!ge(o))return o;if(me(o))return o},Ce=(e,t)=>e,Ee=(e,t)=>t.reduce((o,n)=>n(o),e),X=e=>g.isValidHexColor.test(e),Re=e=>g.isValidWidth.test(e),he=(e,t,o,n,i)=>{let r=t+o,s=e.name+"."+r;if(r.toLocaleLowerCase().includes("bordercolor")){if(!X(String(n)))return e.configError.push(s),i}else if(r.toLocaleLowerCase().includes("backgroundcolor")){if(n===null||n==="null"||String(n).length===0)return ye(s,null),null;if(!X(String(n)))return e.configError.push(s),i}else if(r.toLocaleLowerCase().includes("borderwidth")&&!Re(String(n)))return e.configError.push(s),i;return n},J=(e,t,o,n,i)=>{try{let r=o;i&&i.length&&(r=Ee(o,i));let s=e.config.get(t+r,n);return s===void 0&&console.warn(`Config value for ${o} is undefined or caused an error. Using default value.`),he(e,t,r,s,n)}catch(r){return console.error(`Failed to get config value for ${t+o}:`,r),n}},V={borderColor:{of:"borderOpacity",fn:(e,t,o)=>E(e,t,o)},backgroundColor:{of:"backgroundOpacity",fn:(e,t,o)=>E(e,t,o)}},Oe=(e,t)=>{let o=$[t],n=z[t];return Object.entries(n).reduce((i,[r,s])=>{let a=J(e,o,Ce(r,n),s,[P]);if(a!=null)if(Object.hasOwn(V,r)){let T=V[r];i[r]=T.fn(a,e.generalConfigInfo[T.of],s)}else i[r]=a;return i},{})},ve=(e,t)=>o=>{try{let n=o(e,t);if(!n||n.length===0)return;let i=n.reduce((r,s)=>{let a={...e};return a.borderWidth=s,r.push(a),r},[]).reduce((r,s)=>(r.push(b(s)),r),[]);return i.length===0?void 0:i}catch(n){console.log("creating decoration type thrown error:",t,n);return}},xe=(e,t)=>{if(Object.hasOwn(S,t))return Object.hasOwn(S[t],e.borderPosition)?Se(e,S[t][e.borderPosition]):void 0},Se=(e,t)=>{let o=[];for(let n of t){let i=F(n,e.borderWidth,"0");o.push(i.join(" "))}return o},be=(e,t)=>{let o=t.replaceAll(" ","").split("|"),n=!1,i=!1,r=!1,s=!1,a=!1;return o.length>1&&(n=/isWholeLine/s.test(o[1]),i=/beforeCursor/s.test(o[1]),r=/afterCursor/s.test(o[1]),s=/atLineStart/s.test(o[1]),a=/selectionOnly/s.test(o[1]),e==="MULTI_LINE"&&o[0]==="left"&&(n=!0)),{isWholeLine:n,borderPosition:o[0],beforeCursor:i,afterCursor:r,atLineStart:s,selectionOnly:a}},me=e=>{for(let t in e.generalConfigInfo)e.generalConfigInfo[t]=J(e,"",t,R[t]);for(let t in e.decorationList){let o=t;e.decorationList[o]&&j(e.decorationList[o]);let n=Oe(e,o),i=be(o,n.borderPosition);e.borderPositionInfo[o]=i,n.borderPosition=i.borderPosition,n.isWholeLine=i.isWholeLine;let r=ve(n,o)(xe);if(!r)return!1;e.decorationList[o]=r}return!0};var l=L(require("vscode"));var h=(e,t,o,n)=>new l.Range(new l.Position(e,t),new l.Position(o,n)),u=(e,t)=>new l.Range(e,t),De=(e,t,o)=>new l.Range(new l.Position(e,t),o),O={CURSOR_ONLY:{contentText:e=>`< Editing ... At (Col ${e})`},SINGLE_LINE:{contentText:e=>`< Selection ... Of (${e} Characters)`},MULTI_LINE:{contentText:(e,t,o)=>`< Selection ${o} ... Of (${e} Lines, ${t} Characters, Indent/EOL Ignored)`},MULTI_CURSOR:{contentText:(e,t,o,n)=>`< Multi Selection ... Of (${e} of ${t}, with Total ${o} Lines ${n} Characters )`}},Ue=(e,t)=>[{contentText:O[t.KEY].contentText(e.selection.active.character),range:u(e.selection.active,e.selection.active),isWholeLine:!0}],Ne=(e,t)=>[{contentText:O[t.KEY].contentText(Math.abs(e.selection.end.character-e.selection.start.character)),range:u(e.selection.active,e.selection.active),isWholeLine:!0}],_e=(e,t,o)=>{let i=e.document.getText(e.selection).replace(t.indent.regex,"").length,r=Math.abs(e.selection.end.line-e.selection.start.line)+1;return[{contentText:O[o.KEY].contentText(r,i,"Anchor"),range:u(e.selection.anchor,e.selection.anchor),isWholeLine:!0},{contentText:O[o.KEY].contentText(r,i,"Cursor"),range:u(e.selection.active,e.selection.active),isWholeLine:!0}]},we=(e,t,o)=>{let n=e.selections.length,i=0,r=0,s=0,a=e.selections[0].start.line===e.selections[0].end.line,T=0,w=[],W=[];for(a?T=1:T=Math.abs(e.selections[0].end.line-e.selections[0].start.line)+1;i<n;){if(a)r=r+(e.selections[i].end.character-e.selections[i].start.character),s=s+T;else{let M=e.document.getText(e.selections[i]);r=r+M.replace(t.indent.regex,"").length,s=s+T}i++}for(i=n;i--;)new Set(W).has(e.selections[i].end.line)||(w.push({contentText:O[o.KEY].contentText(i+1,n,s,r),range:u(e.selections[i].start,e.selections[i].end),isWholeLine:!0}),W.push(e.selections[i].end.line),i++);return w},We=(e,t,o)=>({CURSOR_ONLY:()=>Ue(e,o),SINGLE_LINE:()=>Ne(e,o),MULTI_LINE:()=>_e(e,t,o),MULTI_CURSOR:()=>we(e,t,o)}),Me=(e,t)=>{let o=t.statusTextColor,n=t.statusTextOpacity,i=R.statusTextColor,r=R.statusTextOpacity;return{isWholeLine:e.isWholeLine,rangeBehavior:l.DecorationRangeBehavior.ClosedClosed,after:{contentText:e.contentText,color:E(o,n,i,r),backgroundColor:t.statusTextBackgroundColor,fontWeight:"light",fontStyle:"italic",textDecoration:"none",margin:"0 0 0 20px"}}},Y=(e,t,o)=>{let n=[],i=t.length;for(;i--;){let r=b(Me(t[i],o));f(e,r,[t[i].range]),n.push(r)}return n},Be=e=>{let t=e.decorationType.length;for(;t--;)e.decorationType[t].dispose()},q=(e,t,o,n)=>{let i=We(e,t,n)[n.KEY]();t.decorationType&&Be(t),t.decorationType=Y(e,i,o)},Q=e=>{let{editor:t,borderConfig:o,textEditorDecoration:n}=e;return o.isWholeLine?[{decoration:n[0],range:[u(t.selection.active,t.selection.active)]}]:o.beforeCursor?[{decoration:n[0],range:[h(t.selection.active.line,0,t.selection.active.line,t.selection.active.character)]}]:o.afterCursor?[{decoration:n[0],range:[De(t.selection.active.line,t.selection.active.character,t.document.lineAt(t.selection.active.line).range.end)]},{decoration:n[1],range:[h(t.selection.active.line,0,t.selection.active.line,t.selection.active.character)]}]:[]},Z=({editor:e,borderConfig:t,textEditorDecoration:o})=>[{decoration:o[0],range:[u(e.selection.start,e.selection.end)]}],ee=({editor:e,borderConfig:t,textEditorDecoration:o})=>{if(t.borderPosition==="left")return[{decoration:o[2],range:[h(e.selection.start.line,e.selection.start.character,e.selection.end.line,e.selection.end.character)]}];{let n=[];return n.push({decoration:o[0],range:[u(e.selection.start,e.selection.start)]},{decoration:o[1],range:[u(e.selection.end,e.selection.end)]}),Math.abs(e.selection.start.line-e.selection.end.line)>1?n.push({decoration:o[2],range:[h(e.selection.start.line+1,e.selection.start.character,e.selection.end.line-1,e.selection.end.character)]}):f(e,o[2],[]),n}},te=({editor:e,borderConfig:t,textEditorDecoration:o})=>[{decoration:o[0],range:e.selections.reduce((n,i)=>(n.push(u(i.start,i.active)),n),[])},{decoration:o[1],range:e.selections.reduce((n,i)=>(n.push(h(i.active.line,0,i.active.line,i.active.character)),n),[])}];var m=({editor:e,decorationList:t,decorationInfo:o,loadConfig:n})=>{let i=t[o.KEY];if(i){v.editorDecoration=i;let r=Fe({editor:e,decorationList:t,decorationInfo:o,loadConfig:n});if(!r)return;oe(n,e,v,o),r.forEach(({decoration:s,range:a})=>{f(e,s,a)})}},Fe=({editor:e,decorationList:t,decorationInfo:o,loadConfig:n})=>{let i=t[o.KEY];if(i){let r=n.borderPositionInfo[o.KEY];n.generalConfigInfo.statusTextEnabled&&q(e,n.status,n.generalConfigInfo,o);let s={editor:e,borderConfig:r,textEditorDecoration:i};return{CURSOR_ONLY:()=>Q(s),SINGLE_LINE:()=>Z(s),MULTI_LINE:()=>ee(s),MULTI_CURSOR:()=>te(s)}[o.KEY]()}},v={...k},Pe=(e,t)=>{t.forEach(o=>{f(e,o,[])})},oe=(e,t,o,n)=>o.applied?o.applied.MASK!==n.MASK?(Pe(t,e.decorationList[o.applied.KEY]),o.applied=n,!0):!1:(o.applied=n,!0),ne=async e=>{try{await e.extension.activate();let t=_(e);if(!t){console.error("Failed to initialize config.");return}if(!t.decorationList){console.error("Failed to initialize decorationList.");return}let o=c.window.activeTextEditor;return t.configError.length>0&&D(t.configError),o&&m({editor:o,decorationList:t.decorationList,decorationInfo:p.CURSOR_ONLY,loadConfig:t}),[ze(t),Ae(t),Xe(t),je(t),Ve(e)]}catch(t){console.error("Error during extension activation: ",t),c.window.showErrorMessage("Extension activation failed!",t)}},Ge=e=>{if(e.selections.length===1)return e.selections[0].isEmpty?p.CURSOR_ONLY:e.selections[0].isSingleLine?p.SINGLE_LINE:p.MULTI_LINE;if(e.selections.length>1)return p.MULTI_CURSOR},ie=(e,t)=>{e.status.indent.size=Number(t.options.tabSize??t.options.indentSize??4),e.status.indent.type=t.options.insertSpaces?`
`:"	",e.status.indent.regex=t.options.insertSpaces?g.indentRegex(e.status.indent.size):g.tagRegex},He=(e,t,o)=>n=>t?(e.status.decorationType?.forEach(i=>{i.dispose()}),e.decorationList[n.KEY]?.forEach(i=>{Array.isArray(i)?i.forEach(r=>{f(t,r,[])}):f(t,i,[])}),!0):!1,ke=(e,t,o)=>{let n=i=>He(e,t,o)(i);$e(p.RESET,n)},$e=(e,t)=>Object.values(p).filter(o=>e.MASK&o.MASK).map(o=>t(o)).every(Boolean),ze=e=>c.window.onDidChangeWindowState(t=>{t.focused?c.window.activeTextEditor&&m({editor:c.window.activeTextEditor,decorationList:e.decorationList,decorationInfo:p.CURSOR_ONLY,loadConfig:e}):c.window.visibleTextEditors.forEach(o=>{ke(e,o,!0)})}),Ae=e=>c.window.onDidChangeActiveTextEditor(t=>{t&&(e.configError.length>0&&D(e.configError),ie(e,t),c.window.visibleTextEditors.forEach(o=>{v.editorDecoration!==void 0&&v.editorDecoration.forEach(n=>{f(o,n,[])})}),m({editor:t,decorationList:e.decorationList,decorationInfo:p.CURSOR_ONLY,loadConfig:e}))}),je=e=>c.window.onDidChangeTextEditorOptions(t=>{ie(e,t.textEditor)}),Xe=e=>c.window.onDidChangeTextEditorSelection(t=>{if(t.selections){let o=Ge(t.textEditor);if(!o||(oe(e,t.textEditor,v,o),!e.decorationList[o.KEY]))return;m({editor:t.textEditor,decorationList:e.decorationList,decorationInfo:o,loadConfig:e})}}),Ve=e=>c.workspace.onDidChangeConfiguration(t=>{if(t){let o=_(e)}});function Ke(e){ne(e).then(t=>{t&&e.subscriptions.push(...t)})}function Je(){}0&&(module.exports={activate,deactivate});
